var EasyuiUtil=$.extend({},EasyuiUtil);var removeTip=function(){window.setTimeout(function(){$("div.validatebox-tip").remove();},0);};$.fn.panel.defaults.onClose=removeTip;$.fn.window.defaults.onClose=removeTip;$.fn.dialog.defaults.onClose=removeTip;var globalError=function(a){$.messager.progress("close");$.messager.alert("error",a.responseText);};var getGridHeaderMenu=function(j,h){j.preventDefault();var g=$(this);var c=this.headerContextMenu;if(!c){var b=$('<div style="width:100px;"></div>').appendTo("body");var a=g.datagrid("getColumnFields");for(var f=0;f<a.length;f++){var d=g.datagrid("getColumnOption",a[f]);if(!d.hidden){$('<div iconCls="icon-ok" field="'+a[f]+'"/>').html(d.title).appendTo(b);}else{$('<div iconCls="icon-empty" field="'+a[f]+'"/>').html(d.title).appendTo(b);}}c=this.headerContextMenu=b.menu({onClick:function(e){var i=$(e.target).attr("field");if(e.iconCls=="icon-ok"){g.datagrid("hideColumn",i);$(this).menu("setIcon",{target:e.target,iconCls:"icon-empty"});}else{g.datagrid("showColumn",i);$(this).menu("setIcon",{target:e.target,iconCls:"icon-ok"});}}});}c.menu("show",{left:j.pageX,top:j.pageY});};$.fn.datagrid.defaults.onHeaderContextMenu=getGridHeaderMenu;$.fn.treegrid.defaults.onHeaderContextMenu=getGridHeaderMenu;var panelOnMove=function(b,e){var j=b;var i=e;if(j<1){j=1;}if(i<1){i=1;}var a=parseInt($(this).parent().css("width"))+14;var g=parseInt($(this).parent().css("height"))+14;var f=j+a;var d=i+g;var h=$(window).width();var c=$(window).height();if(f>h){j=h-a;}if(d>c){i=c-g;}$(this).parent().css({left:j,top:i});};$.fn.dialog.defaults.onMove=panelOnMove;$.fn.window.defaults.onMove=panelOnMove;$.fn.panel.defaults.onMove=panelOnMove;EasyuiUtil.dialog=function(a){var b=$.extend({modal:true,onClose:function(){$(this).dialog("destroy");}},a);return $("<div/>").dialog(b);};EasyuiUtil.changeTheme=function(f){var e=$("#_theme");var d=e.attr("href");var b=d.substring(0,d.indexOf("themes"))+"themes/"+f+"/easyui.css";e.attr("href",b);var g=$("iframe");if(g.length>0){for(var c=0,a=g.length;c<a;c++){var h=g[c];$(h).contents().find("#theme").attr("href",b);}}$.cookie("themeName",f,{expires:3});};if($.cookie("themeName")){EasyuiUtil.changeTheme($.cookie("themeName"));}EasyuiUtil.rootPath=function(){var c=window.document.location.href;var d=window.document.location.pathname;var e=c.indexOf(d);var b=c.substring(0,e);var a=d.substring(0,d.substr(1).indexOf("/")+1);return(b+a);};EasyuiUtil.contextPath=function(){return window.document.location.pathname.substring(0,window.document.location.pathname.indexOf("/",1));};EasyuiUtil.formatStr=function(b){for(var a=0;a<arguments.length-1;a++){b=b.replace("{"+a+"}",arguments[a+1]);}return b;};EasyuiUtil.nameSpace=function(){var e={},b;for(var d=0,a=arguments.length;d<a;d++){b=arguments[d].split(".");e=window[b[0]]=window[b[0]]||{};for(var c=0;c<b.slice(1).length;c++){e=e[b[c+1]]=e[b[c+1]]||{};}}return e;};EasyuiUtil.randomFour=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1);};EasyuiUtil.UUID=function(){return(EasyuiUtil.randomFour()+EasyuiUtil.randomFour()+"-"+EasyuiUtil.randomFour()+"-"+EasyuiUtil.randomFour()+"-"+EasyuiUtil.randomFour()+"-"+EasyuiUtil.randomFour()+EasyuiUtil.randomFour()+EasyuiUtil.randomFour());};EasyuiUtil.getUrlParam=function(b){var c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)");var a=window.location.search.substr(1).match(c);if(a!=null){return unescape(a[2]);}return null;};EasyuiUtil.getValuesExt=function(e){if(e!=undefined&&e!=""){var b=[];var d=e.split(",");for(var c=0,a=d.length;c<a;c++){b.push(""+d[c]);}return b;}else{return[];}};EasyuiUtil.isLessThanIe8=function(){return($.browser.msie&&$.browser.version<8);};EasyuiUtil.serializeObj=function(a){var b={};$.each(a.serializeArray(),function(c){if(b[this["name"]]){b[this["name"]]=b[this["name"]]+","+this["value"];}else{b[this["name"]]=this["value"];}});return b;};EasyuiUtil.jsonToStr=function(d){var c=[];if(typeof d=="string"){return'"'+d.replace(/([\'\"\\])/g,"\\$1").replace(/(\n)/g,"\\n").replace(/(\r)/g,"\\r").replace(/(\t)/g,"\\t")+'"';}if(typeof d=="object"){if(!d.sort){for(var b in d){c.push(b+":"+ExtCommWebUI.hashMap.obj2str(d[b]));}if(!!document.all&&!/^\n?function\s*toString\(\)\s*\{\n?\s*\[native code\]\n?\s*\}\n?\s*$/.test(d.toString)){c.push("toString:"+d.toString.toString());}c="{"+c.join()+"}";}else{for(var b=0,a=d.length;b<a;b++){c.push(ExtCommWebUI.hashMap.obj2str(d[b]));}c="["+c.join()+"]";}return c;}return d.toString();};Date.prototype.formatDatetime=function(b){if(isNaN(this.getMonth())){return"";}if(!b){b="yyyy-MM-dd hh:mm:ss";}var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(b)){b=b.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));}for(var a in c){if(new RegExp("("+a+")").test(b)){b=b.replace(RegExp.$1,RegExp.$1.length==1?c[a]:("00"+c[a]).substr((""+c[a]).length));}}return b;};EasyuiUtil.getFrameDoc=function(a){return a&&typeof(a)=="object"&&a.tagName=="IFRAME"&&a.contentDocument||a.contentWindow&&a.contentWindow.document||a.document;};EasyuiUtil.getFrameWin=function(a){return a&&typeof(a)=="object"&&a.tagName=="IFRAME"&&a.contentWindow;};EasyuiUtil.loadTree=function(b,a){$("#"+b).tree({data:a,lines:true,onClick:function(c){if(c.attributes){EasyuiUtil.addTab(c.text,c.attributes.url);}}});};EasyuiUtil.loadTreeCbFun=function(id,data,func){$("#"+id).tree({data:data,lines:true,onClick:function(node){if(node.attributes){var _func=eval(func);if(_func){_func(node.text,node.attributes.url);}}}});};EasyuiUtil.getIframe=function(a){return'<iframe name="mainFrame" scrolling="auto" frameborder="0" noresize="noresize" src="'+a+'" style="width:100%;height:100%;"></iframe>';};EasyuiUtil.addTab=function(b,a){if($("#tabs").tabs("exists",text)){$("#tabs").tabs("select",text);}else{$("#tabs").tabs("add",{title:b,closable:true,content:EasyuiUtil.getIframe(a)});}};EasyuiUtil.setRightMenu=function(a){$("#tabs").tabs({onContextMenu:function(b,c){b.preventDefault();$("#"+a).menu("show",{left:b.pageX,top:b.pageY}).data("tabTitle",c);}});$("#"+a).menu({onClick:function(b){EasyuiUtil.closeTab(this,b.name);}});};EasyuiUtil.closeTab=function(h,g){var c=$(h).data("tabTitle");var e=$("#tabs");if(g=="close"){e.tabs("close",c);return;}var b=e.tabs("tabs");var f=[];$.each(b,function(){var i=$(this).panel("options");if(i.closable&&i.title!=c&&g=="Other"){f.push(i.title);}else{if(i.closable&&g=="All"){f.push(i.title);}}});for(var d=0,a=f.length;d<a;d++){e.tabs("close",f[d]);}};EasyuiUtil.iframeOpen=function(b,a){$(b).window({onClose:function(){$(this).window("destroy");}});if(a){a.call(b);}};(function(b){var a=b.ajax;a._reuqestsCache={};b.ajaxSetup({mode:"block",index:0,cache:false,global:false,type:"POST",beforeSend:function(d,c){if(c.mode){if(c.mode==="abort"&&c.index){if(a._reuqestsCache[c.index]){a._reuqestsCache[c.index].abort();}}a._reuqestsCache[c.index]=d;}}});b.extend({getJSON:function(d,f,g,c){c=b.extend({},arguments[arguments.length-1]||{});if(c.mode==="block"&&c.index){if(a._reuqestsCache[c.index]){return false;}a._reuqestsCache[c.index]=true;}if(c.crossDomain){c.dataType="jsonp";}var e="json";if(b.isFunction(f)){g=f;f=null;}c=b.extend({type:"POST",url:d,data:f,success:g,dataType:"json"},c);return b.ajax(c);}});b(document).ajaxComplete(function(e,d,f){if(f.index){a._reuqestsCache[f.index]=null;}});})(jQuery);